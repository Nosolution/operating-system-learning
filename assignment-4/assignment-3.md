# 2019 操作系统实验（三）

本次实验的重点在于掌握：操作系统的中断与异常、IO操作机制、实模式和保护模式下中
断的异同。

## 1.编写OS 层次的IO 程序

参考《Orange’s》, 在之前搭建的nasm+bochs平台上完成一个接受键盘输入，回显到屏幕上的程序。

### 1.1 基本功能

- 从从屏幕左上角开始，显示键盘输入的字符。可以输入并显示a-z,A-Z和0-9字符。
- 大小写切换包括Shift组合键以及大写锁定两种方式。大写锁定后再用Shift组合键将会输入小写字母
- 支持回车键换行。
- 支持用退格键删除输入内容。
- 支持空格键和Tab键（4或8个空格，可以被统一的删除）。
- 不要求支持方向键移动光标。
- 每隔20秒左右, 清空屏幕。输入的字符重新从屏幕左上角开始显示。
- 要求有光标显示, 闪烁与否均可, 但一定要跟随输入字符的位置变化。
- 按Esc键进入查找模式，在查找模式中不会清空屏幕。此时输入关键字，被输入的关键字以不同于之前所输入文字的另一种颜色显示，按回车后，所有匹配的文本(区分大小写) 以此种颜色显示，并屏蔽除Esc之外任何输入。再按Esc键，之前输入的关键字被自动删除，所有文本恢复同一颜色, 光标回到正确位置。参见示例。

### 1.2 示例

示例中用`*`括起目标文本以示颜色改变。  
初始状态:

```text
I have a nice friend.
A nice friend has a nice cat.
```

按下Esc, 输入’nice’ :

```text
I have a nice friend.
A nice friend has a nice cat. *nice*
```

按下回车

```text
I have a *nice* friend.
A *nice* friend has a *nice* cat. *nice*
```

再按下Esc

```text
I have a nice friend.
A nice friend has a nice cat.
```

### 1.3 附加功能

- 按下control + z组合键可以撤回上一个输入的字符（包含回车和Tab和删除）。

### 1.4 要求

- 使用make构建整个项目，程序必须进入到保护模式下完成。
- 提交代码(包含makefile) 和运行截图，其中makefile 必须支持make run 命令，即在shell中进入代码文件所在目录，输入make run 并回车可直接启动程序，不需要其他命令。

### 1.5 评分规则

- 实现基准要求7 分
- 实现基准要求和附加要求8分

### 1.6 关于代码实现

- 可以使用《orange’s 一个操作系统的实现》书附录光盘代码，在其基础上修改实现。
- 仔细阅读《orange’s 一个操作系统的实现》第三章，第四章和第五章的内容。
